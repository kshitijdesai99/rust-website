"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{11053:function(he,B,a){a.r(B),a.d(B,{default:function(){return te}});var E=a(15009),o=a.n(E),G=a(97857),j=a.n(G),V=a(99289),h=a.n(V),W=a(5574),A=a.n(W),D=a(2393),I=a(2618),g=a(76772);function H(p,t){return L.apply(this,arguments)}function L(){return L=h()(o()().mark(function p(t,n){return o()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,g.request)("/api/login/captcha",j()({method:"GET",params:j()({},t)},n||{})));case 1:case"end":return v.stop()}},p)})),L.apply(this,arguments)}var J=a(87547),b=a(94149),K=a(24454),Q=a(88641),X=a(68262),F=a(5966),Y=a(16434),q=a(38925),x=a(2453),_=a(11941),ee=a(67610),w=a(67294),ae=a(73935),se=a(28846),e=a(85893),C=(0,se.kc)(function(p){var t=p.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:t.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:t.borderRadius,":hover":{backgroundColor:t.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),ve=function(){var t=C(),n=t.styles;return _jsxs(_Fragment,{children:[_jsx(AlipayCircleOutlined,{className:n.action},"AlipayCircleOutlined"),_jsx(TaobaoCircleOutlined,{className:n.action},"TaobaoCircleOutlined"),_jsx(WeiboCircleOutlined,{className:n.action},"WeiboCircleOutlined")]})},Me=function(){var t=C(),n=t.styles;return _jsx("div",{className:n.lang,"data-lang":!0,children:SelectLang&&_jsx(SelectLang,{})})},P=function(t){var n=t.content;return(0,e.jsx)(q.Z,{style:{marginBottom:24},message:n,type:"error",showIcon:!0})},re=function(){var t,n,U=(0,w.useState)({}),v=A()(U,2),$=v[0],ne=v[1],ie=(0,w.useState)("account"),k=A()(ie,2),y=k[0],le=k[1],O=(0,g.useModel)("@@initialState"),M=O.initialState,ue=O.setInitialState,oe=(0,g.useSearchParams)(),z=A()(oe,2),ce=z[0],ye=z[1],de=C(),ge=de.styles,m=(0,g.useIntl)(),N=function(){var f=h()(o()().mark(function i(){var r,l;return o()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,M==null||(r=M.fetchUserInfo)===null||r===void 0?void 0:r.call(M);case 2:l=u.sent,l&&(0,ae.flushSync)(function(){ue(function(S){return j()(j()({},S),{},{currentUser:l})})});case 4:case"end":return u.stop()}},i)}));return function(){return f.apply(this,arguments)}}(),me=function(){var f=h()(o()().mark(function i(r){var l,s,u;return o()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,(0,I.ZA)(j()({},r));case 3:if(l=c.sent,!l.success){c.next=8;break}return s=l.message,x.ZP.success(s),c.abrupt("return");case 8:console.log(l),c.next=16;break;case 11:c.prev=11,c.t0=c.catch(0),u=m.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(c.t0),x.ZP.error(u);case 16:case"end":return c.stop()}},i,null,[[0,11]])}));return function(r){return f.apply(this,arguments)}}(),fe=function(){var f=h()(o()().mark(function i(r){var l,s,u,S;return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,(0,I.JS)({email:r.username,password:r.password});case 3:if(l=d.sent,!l.token){d.next=13;break}return localStorage.setItem("auth_token",l.token),s=m.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),x.ZP.success(s),d.next=10,N();case 10:return u=new URL(window.location.href).searchParams,g.history.push(u.get("redirect")||"/"),d.abrupt("return");case 13:console.log(l),ne(l),d.next=22;break;case 17:d.prev=17,d.t0=d.catch(0),S=m.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(d.t0),x.ZP.error(S);case 22:case"end":return d.stop()}},i,null,[[0,17]])}));return function(r){return f.apply(this,arguments)}}(),Z=$.status,T=$.type,pe=function(){var f=h()(o()().mark(function i(){var r;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(r=ce.get("t"),!(r&&r.length>0)){s.next=7;break}return localStorage.setItem("auth_token",r),s.next=5,N();case 5:return g.history.push("/"),s.abrupt("return");case 7:case"end":return s.stop()}},i)}));return function(){return f.apply(this,arguments)}}();pe();var R=location.hostname==="localhost"||location.hostname==="pro-demo.mycustompart.com"||location.hostname==="sea-orm-pro-demo.sea-ql.org";return(0,e.jsxs)("div",{className:ge.container,children:[(0,e.jsx)(g.Helmet,{children:(0,e.jsxs)("title",{children:[m.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",(t=ee.Z.site)===null||t===void 0||(t=t.theme)===null||t===void 0?void 0:t.title]})}),(0,e.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,e.jsxs)(X.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},initialValues:{autoLogin:!0},onFinish:function(){var f=h()(o()().mark(function i(r){return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(y!=="email"){s.next=5;break}return s.next=3,me(r);case 3:s.next=8;break;case 5:if(y!=="account"){s.next=8;break}return s.next=8,fe(r);case 8:case"end":return s.stop()}},i)}));return function(i){return f.apply(this,arguments)}}(),children:[(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,e.jsx)("img",{alt:"logo",src:M==null||(n=M.settings)===null||n===void 0||(n=n.site)===null||n===void 0||(n=n.theme)===null||n===void 0?void 0:n.login_banner,style:{width:"300px"}})}),(0,e.jsx)(_.Z,{activeKey:y,onChange:le,centered:!0,items:[{key:"account",label:m.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})}]}),Z==="error"&&T==="account"&&(0,e.jsx)(P,{content:m.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),y==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(J.Z,{})},placeholder:m.formatMessage({id:"pages.login.username.placeholder_",defaultMessage:R?"Username: demo@sea-ql.org":"Username"}),rules:[{required:!0,message:(0,e.jsx)(g.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(F.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(b.Z,{})},placeholder:m.formatMessage({id:"pages.login.password.placeholder_",defaultMessage:R?"Password: demo@sea-ql.org":"Password"}),rules:[{required:!0,message:(0,e.jsx)(g.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),Z==="error"&&T==="mobile"&&(0,e.jsx)(P,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),y==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(K.Z,{})},name:"mobile",placeholder:m.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(g.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(g.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(Y.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(b.Z,{})},captchaProps:{size:"large"},placeholder:m.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(i,r){return i?"".concat(r," ").concat(m.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):m.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(g.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var f=h()(o()().mark(function i(r){var l;return o()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,H({phone:r});case 2:if(l=u.sent,l){u.next=5;break}return u.abrupt("return");case 5:x.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return u.stop()}},i)}));return function(i){return f.apply(this,arguments)}}()})]}),Z==="error"&&T==="email"&&(0,e.jsx)(P,{content:"Invalid Verification Token"}),y==="email"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(F.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(Q.Z,{})},name:"email",placeholder:m.formatMessage({id:"pages.login.email.placeholder",defaultMessage:"Email"}),rules:[{required:!0,message:(0,e.jsx)(g.FormattedMessage,{id:"pages.login.email.required",defaultMessage:"Email Required!"})}]})})]})}),(0,e.jsx)(D.$_,{})]})},te=re}}]);
